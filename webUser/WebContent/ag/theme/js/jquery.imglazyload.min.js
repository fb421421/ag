!function(a){a.fn.imglazyload=function(b){var c=a.extend({attr:"lazy-src",container:window,event:"scroll",fadeIn:!1,threshold:0,vertical:!0,loadScript:!1},b),d=c.event,e=c.vertical,f=a(c.container),g=c.threshold,h=c.loadScript,i=a.makeArray(a(this)),j="imglazyload_offset",k=e?"top":"left",l=e?"scrollTop":"scrollLeft",m=e?f.height():f.width(),n=f[l](),o=m+n,p=[],q=function(a){p.push(a),"runing"!==p[0]&&r()},r=function(){var a=p.shift();"runing"===a&&(a=p.shift()),a&&(p.unshift("runing"),a())},s=function(a){var b=a.value.match(/src="([\s\S]*?)"/i)[1],c=a.parentNode,d=document.write,e=document.createElement("script"),f=document.head||document.getElementsByTagName("head")[0]||document.documentElement;document.write=function(a){c.innerHTML=a},e.type="text/javascript",e.src=b,e.onerror=e.onload=e.onreadystatechange=function(b){b=b||window.event,(!e.readyState||/loaded|complete/.test(e.readyState)||"error"===b)},f.insertBefore(e,f.firstChild)},t={init:function(a){return a>=n&&o+g>=a},scroll:function(a){var b=f[l]();return a>=b&&m+b+g>=a},resize:function(a){var b=f[l](),c=e?f.height():f.width();return a>=b&&c+b+g>=a}},u=function(b,d){var l,m,n,o,p,e=0,g=!1;for(d?"scroll"!==d&&"resize"!==d&&(g=!0):d="init";e<i.length;e++)l=!1,n=i[e],o=a(n),(h||(p=o.attr(c.attr),p&&n.src!==p))&&(m=o.data(j),void 0===m&&(m=h?o.parent().offset()[k]:o.offset()[k],o.data(j,m)),l=g||t[d](m),l&&(h?function(a){q(function(){s(a)})}(n):(n.src=p,a.browser.msie&&"6.0"==a.browser.version&&a(n).css("visibility","visible"),c.fadeIn&&o.hide().fadeIn()),o.removeData(j),i.splice(e--,1)));i.length||(b?b.unbind(d,v):f.unbind(c.event,v),a(window).unbind("resize",v),i=null),n=o=null},v=function(b){u(a(this),b.type)};return f="scroll"===d?f:a(this),f.bind(d,v),a(window).bind("resize",v),u(),this}}(jQuery);